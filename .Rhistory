segments(x0=asr_x.mk[,"bin"],y0=rep(0,nsim),
x1=asr_x.mk[,"bin"],y1=asr_x.mk[,"prop"],
col="grey")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.mk$count),
round(exp(mean(log(asr_x.mk$count)))),
prettyNum(max(asr_x.mk$count),big.mark=",")),"probs")),
lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.mk$count)/4),
mean(log(asr_x.mk$count)/4),
max(log(asr_x.mk$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("a)",adj=0,line=1)
##
plot(NA,xlim=c(0,1),ylim=c(0,1),
las=1,cex.axis=0.7,cex.lab=0.8,bty="n",
xlab="marginal scaled likelihoods",
ylab="relative frequency true state")
lines(c(0,1),c(0,0),lty="dotted")
segments(x0=asr_x.thresh[,"bin"],y0=rep(0,nsim),
x1=asr_x.thresh[,"bin"],y1=asr_x.thresh[,"prop"],col="grey")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,
bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.thresh$count),
round(exp(mean(log(asr_x.thresh$count)))),
prettyNum(max(asr_x.thresh$count),big.mark=","),
"probs")),lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.thresh$count)/4),
mean(log(asr_x.thresh$count)/4),
max(log(asr_x.thresh$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("b)",adj=0,line=1)
legend("topleft",c("1:1 line",
paste(c(min(asr_x.thresh$count),
round(exp(mean(log(asr_x.thresh$count)))),
prettyNum(max(asr_x.thresh$count),big.mark=",")),
"probs")),lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.thresh$count)/4),
mean(log(asr_x.thresh$count)/4),
max(log(asr_x.thresh$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
par(mfrow=c(1,2),mar=c(5.1,4.1,3.1,1.1))
plot(NA,xlim=c(0,1),ylim=c(0,1),
las=1,cex.axis=0.7,cex.lab=0.8,bty="n",
xlab="marginal scaled likelihoods",
ylab="relative frequency true state")
lines(c(0,1),c(0,0),lty="dotted")
segments(x0=asr_x.mk[,"bin"],y0=rep(0,nsim),
x1=asr_x.mk[,"bin"],y1=asr_x.mk[,"prop"],
col="grey")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.mk$count),
round(exp(mean(log(asr_x.mk$count)))),
prettyNum(max(asr_x.mk$count),big.mark=",")),"probs")),
lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.mk$count)/4),
mean(log(asr_x.mk$count)/4),
max(log(asr_x.mk$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("a)",adj=0,line=1)
##
plot(NA,xlim=c(0,1),ylim=c(0,1),
las=1,cex.axis=0.7,cex.lab=0.8,bty="n",
xlab="marginal scaled likelihoods",
ylab="relative frequency true state")
lines(c(0,1),c(0,0),lty="dotted")
segments(x0=asr_x.thresh[,"bin"],y0=rep(0,nsim),
x1=asr_x.thresh[,"bin"],y1=asr_x.thresh[,"prop"],col="grey")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,
bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.thresh$count),
prettyNum(round(exp(mean(log(asr_x.thresh$count)))),big.mark=","),
prettyNum(max(asr_x.thresh$count),big.mark=",")),
"probs")),lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.thresh$count)/4),
mean(log(asr_x.thresh$count)/4),
max(log(asr_x.thresh$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("b)",adj=0,line=1)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete")
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.05)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.05)
set.seed(99)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete")
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.05)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.05)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete")
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.05)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.05)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete")
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete")
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=2,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1),lwd=1)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=1,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=1.5,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted")
axis(1,cex.axis=0.8)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=1.5,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
getwd()
save(trees,x,x.obs,thresh_fits,anc_x.thresh,asr_x.thresh,
mk_fits,anc_x.mk,asr_x.mk,file="data/asr-thresh.rda")
list.files()
setwd("../Revell.AncestralReconstruction/")
save(trees,x,x.obs,thresh_fits,anc_x.thresh,asr_x.thresh,
mk_fits,anc_x.mk,asr_x.mk,file="data/asr-thresh.rda")
load("data/asr-thresh.rda")
par(mfrow=c(1,2),mar=c(5.1,4.1,3.1,1.1))
plot(NA,xlim=c(0,1),ylim=c(0,1),
las=1,cex.axis=0.7,cex.lab=0.8,bty="n",
xlab="marginal scaled likelihoods",
ylab="relative frequency true state")
lines(c(0,1),c(0,0),lty="dotted")
segments(x0=asr_x.mk[,"bin"],y0=rep(0,nsim),
x1=asr_x.mk[,"bin"],y1=asr_x.mk[,"prop"],
col="grey")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.mk[,c("bin","prop")],pch=21,
cex=log(asr_x.mk$count)/4,bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.mk$count),
round(exp(mean(log(asr_x.mk$count)))),
prettyNum(max(asr_x.mk$count),big.mark=",")),"probs")),
lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.mk$count)/4),
mean(log(asr_x.mk$count)/4),
max(log(asr_x.mk$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("a)",adj=0,line=1)
##
plot(NA,xlim=c(0,1),ylim=c(0,1),
las=1,cex.axis=0.7,cex.lab=0.8,bty="n",
xlab="marginal scaled likelihoods",
ylab="relative frequency true state")
lines(c(0,1),c(0,0),lty="dotted")
segments(x0=asr_x.thresh[,"bin"],y0=rep(0,nsim),
x1=asr_x.thresh[,"bin"],y1=asr_x.thresh[,"prop"],col="grey")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,bg="white")
lines(c(0,1),c(0,1),lwd=2,col="black",lty="dashed")
points(asr_x.thresh[,c("bin","prop")],pch=21,
cex=log(asr_x.thresh$count)/4,
bg=make.transparent("grey",0.7))
legend("topleft",c("1:1 line",
paste(c(min(asr_x.thresh$count),
prettyNum(round(exp(mean(log(asr_x.thresh$count)))),big.mark=","),
prettyNum(max(asr_x.thresh$count),big.mark=",")),
"probs")),lwd=c(2,NA,NA,NA),
pch=c(NA,21,21,21),
lty=c("dashed",NA,NA,NA),
col=c("black","black","black","black"),
pt.bg=c(NA,"grey","grey","grey"),
pt.cex=round(c(NA,min(log(asr_x.thresh$count)/4),
mean(log(asr_x.thresh$count)/4),
max(log(asr_x.thresh$count)/4)),4),
bty="n",inset=0.05,cex=0.8,y.intersp=1.5,
seg.len=3)
mtext("b)",adj=0,line=1)
set.seed(77)
N<-200
t<-100
b<-(log(N)-log(2))/t
tree<-pbtree(b=b,n=N,t=t,type="discrete",quiet=TRUE)
layout(mat=matrix(c(1,2),1,2),widths=c(0.5,0.5))
par(mar=c(3.1,1.1,2.1,0.1),
col.lab="transparent",fg="transparent",
col.axis="transparent")
th<-c(0,2)
cols<-grey(seq(0,0.8,length.out=3))
tt<-bmPlot(tree,type="threshold",
anc=mean(th),thresholds=th,axes=FALSE,
sig2=1/t,bty="n",ngen=t,colors=cols)
par(col.lab="black",fg="black",
col.axis="black")
abline(v=th,lty="dotted",lwd=2)
axis(1,cex.axis=0.8)
mtext("a)",line=0.5,adj=0.01)
plot(tt$tree,tt$colors,lwd=1.5,direction="upwards",ftype="off",
mar=c(3.1,1.1,2.1,1.1))
mtext("b)",line=0.5,adj=0.01)
library(phytools)
library(expm)
library(doParallel)
library(foreach)
##  out.width = "100%",
tree<-read.tree(text="(C:0.7,(B:0.3,A:0.3):0.4);")
x<-setNames(c(0,0,1),LETTERS[3:1])
tt<-bind.tip(tree,"internal",edge.length=0,where=5)
plotTree(tree,ftype="i",offset=1,fsize=1.2,ylim=c(1,3.2))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
points(pp$xx[4:5],pp$yy[4:5],pch=21,cex=2,bg="white")
points(pp$xx[4:5],pp$yy[4:5],pch=16,cex=1.2,col="black")
text(pp$xx[4]+0.05,pp$yy[4]-0.05,"root",font=3)
text(pp$xx[5],pp$yy[5]-0.15,"internal",font=3,pos=2)
points(rep(0.7,3),1:3,pch=22,cex=2.5,bg=c("white","white","black"))
text(0.35,1.1,expression(paste('t'[C]," = 0.7")),cex=0.8)
text(0.2,2.6,expression(paste('t'[AB]," = 0.4")),cex=0.8)
text(0.55,2.1,expression(paste('t'[B]," = 0.3")),cex=0.8)
text(0.55,3.1,expression(paste('t'[A]," = 0.3")),cex=0.8)
legend("topleft",legend=0:1,pch=22,pt.bg=c("white","black"),
pt.cex=2.5,bty="n",horiz=TRUE,inset=0.02)
Q<-matrix(c(-0.2,0.2,0.2,-0.2),2,2,
dimnames=list(0:1,0:1))
expm(Q*0.4)->P4
P4
expm(Q*0.7)->P7
P7
expm(Q*0.3)->P3
P3
P=0.5*P4[1,1]*P3[1,2]*P3[1,1]*P7[1,1]+
0.5*P4[1,2]*P3[2,2]*P3[2,1]*P7[1,1]+
0.5*P4[2,1]*P3[1,2]*P3[1,1]*P7[2,1]+
0.5*P4[2,2]*P3[2,2]*P3[2,1]*P7[2,1]
P
P0=0.5*P4[1,1]*P3[1,2]*P3[1,1]*P7[1,1]+
0.5*P4[1,2]*P3[2,2]*P3[2,1]*P7[1,1]
P0
P1=0.5*P4[2,1]*P3[1,2]*P3[1,1]*P7[2,1]+
0.5*P4[2,2]*P3[2,2]*P3[2,1]*P7[2,1]
P1
c(P0,P1)/(P0+P1)
P0=0.5*P4[1,1]*P3[1,2]*P3[1,1]*P7[1,1]+
0.5*P4[2,1]*P3[1,2]*P3[1,1]*P7[2,1]
P0
P1=0.5*P4[1,2]*P3[2,2]*P3[2,1]*P7[1,1]+
0.5*P4[2,2]*P3[2,2]*P3[2,1]*P7[2,1]
P1
c(P0,P1)/(P0+P1)
par(mfrow=c(1,2))
plotTree(tree,ftype="i",offset=1,fsize=1.2,mar=c(0.1,1.1,2.1,1.1),
xlim=c(-0.1,0.9),ylim=c(0.7,3.3))
points(rep(0.7,3),1:3,pch=22,cex=2.5,bg=c("white","white","black"))
anc<-ancr(fitMk(tree,x,fixedQ=Q))
nodelabels(pie=anc$ace,piecol=c("white","black"),cex=2)
mtext("a) marginal reconstruction",adj=0.1,line=1,cex=0.8)
plotTree(tree,ftype="i",offset=1,fsize=1.2,mar=c(0.1,1.1,2.1,1.1),
xlim=c(-0.1,0.9),ylim=c(0.7,3.3))
points(rep(0.7,3),1:3,pch=22,cex=2.5,bg=c("white","white","black"))
nodelabels(pie=matrix(c(1,1,0,0)),piecol=c("white","black"),cex=2)
mtext("b) joint reconstruction",adj=0.1,line=1,cex=0.8)
